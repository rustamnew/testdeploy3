import{l as te,an as ie,ao as ue,m as oe,q as z,R as ce,s as de,$ as fe,D as me,u as p,J as pe,G as ne,g as E,ap as _e,I as B,aq as ve,ar as he,L as ge,as as be,x as se,y as xe,o as w,c as O,a as N,_ as we,k as U,w as h,t as L,f as M,F as J,r as R,b as u,A as H,d as G,j as Q,B as le,p as ye,e as Se,at as ke}from"./entry.BXnrCNv6.js";import{u as Ve,a as Ce,b as $e,c as Oe}from"./useNotification.CtrOdVra.js";import{u as Ne}from"./data.CJNdPfil.js";import{_ as qe,a as Ee}from"./QCardSection.BqsXZTLj.js";import{_ as Ae}from"./QInput.DANEc9tc.js";import{m as Ie,n as ze,_ as De}from"./QDialog.zY2dxUrx.js";import{u as Je}from"./vue.f36acd1f.D5qHZy9J.js";import"./use-dark.D6NxtXU6.js";import"./use-timeout.BSSs-esP.js";const Te=te({name:"QCardActions",props:{...ie,vertical:Boolean},setup(e,{slots:t}){const o=ue(e),s=oe(()=>`q-card__actions ${o.value} q-card__actions--${e.vertical===!0?"vert column":"horiz row"}`);return()=>z("div",{class:s.value},ce(t.default))}}),je=z("div",{key:"svg",class:"q-checkbox__bg absolute"},[z("svg",{class:"q-checkbox__svg fit absolute-full",viewBox:"0 0 24 24"},[z("path",{class:"q-checkbox__truthy",fill:"none",d:"M1.73,12.91 8.1,19.28 22.79,4.59"}),z("path",{class:"q-checkbox__indet",d:"M4,14H20V10H4"})])]),Fe=te({name:"QCheckbox",props:Ve,emits:Ce,setup(e){function t(o,s){const n=oe(()=>(o.value===!0?e.checkedIcon:s.value===!0?e.indeterminateIcon:e.uncheckedIcon)||null);return()=>n.value!==null?[z("div",{key:"icon",class:"q-checkbox__icon-container absolute-full flex flex-center no-wrap"},[z(de,{class:"q-checkbox__icon",name:n.value})])]:[je]}return $e("checkbox",t)}});function X(e){if(e===!1)return 0;if(e===!0||e===void 0)return 1;const t=parseInt(e,10);return isNaN(t)?0:t}const Pe=fe({name:"close-popup",beforeMount(e,{value:t}){const o={depth:X(t),handler(s){o.depth!==0&&setTimeout(()=>{const n=Ie(e);n!==void 0&&ze(n,s,o.depth)})},handlerKey(s){me(s,13)===!0&&o.handler(s)}};e.__qclosepopup=o,e.addEventListener("click",o.handler),e.addEventListener("keyup",o.handlerKey)},updated(e,{value:t,oldValue:o}){t!==o&&(e.__qclosepopup.depth=X(t))},beforeUnmount(e){const t=e.__qclosepopup;e.removeEventListener("click",t.handler),e.removeEventListener("keyup",t.handlerKey),delete e.__qclosepopup}});function Ue(e){return ve()?(he(e),!0):!1}function K(e){return typeof e=="function"?e():p(e)}const Le=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const Me=Object.prototype.toString,Re=e=>Me.call(e)==="[object Object]",We=()=>{};function Be(e,t){function o(...s){return new Promise((n,i)=>{Promise.resolve(e(()=>t.apply(this,s),{fn:t,thisArg:this,args:s})).then(n).catch(i)})}return o}const re=e=>e();function Ke(e=re){const t=E(!0);function o(){t.value=!1}function s(){t.value=!0}const n=(...i)=>{t.value&&e(...i)};return{isActive:_e(t),pause:o,resume:s,eventFilter:n}}function He(e){return e||ge()}function Ge(e,t,o={}){const{eventFilter:s=re,...n}=o;return B(e,Be(s,t),n)}function Qe(e,t,o={}){const{eventFilter:s,...n}=o,{eventFilter:i,pause:d,resume:g,isActive:_}=Ke(s);return{stop:Ge(e,t,{...n,eventFilter:i}),pause:d,resume:g,isActive:_}}function Xe(e,t=!0,o){He()?pe(e,o):t?e():ne(e)}function Ye(e){var t;const o=K(e);return(t=o==null?void 0:o.$el)!=null?t:o}const W=Le?window:void 0;function Y(...e){let t,o,s,n;if(typeof e[0]=="string"||Array.isArray(e[0])?([o,s,n]=e,t=W):[t,o,s,n]=e,!t)return We;Array.isArray(o)||(o=[o]),Array.isArray(s)||(s=[s]);const i=[],d=()=>{i.forEach(m=>m()),i.length=0},g=(m,c,b,v)=>(m.addEventListener(c,b,v),()=>m.removeEventListener(c,b,v)),_=B(()=>[Ye(t),K(n)],([m,c])=>{if(d(),!m)return;const b=Re(c)?{...c}:c;i.push(...o.flatMap(v=>s.map(k=>g(m,v,k,b))))},{immediate:!0,flush:"post"}),f=()=>{_(),d()};return Ue(f),f}const F=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},P="__vueuse_ssr_handlers__",Ze=et();function et(){return P in F||(F[P]=F[P]||{}),F[P]}function tt(e,t){return Ze[e]||t}function ot(e){return e==null?"any":e instanceof Set?"set":e instanceof Map?"map":e instanceof Date?"date":typeof e=="boolean"?"boolean":typeof e=="string"?"string":typeof e=="object"?"object":Number.isNaN(e)?"any":"number"}const nt={boolean:{read:e=>e==="true",write:e=>String(e)},object:{read:e=>JSON.parse(e),write:e=>JSON.stringify(e)},number:{read:e=>Number.parseFloat(e),write:e=>String(e)},any:{read:e=>e,write:e=>String(e)},string:{read:e=>e,write:e=>String(e)},map:{read:e=>new Map(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e.entries()))},set:{read:e=>new Set(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e))},date:{read:e=>new Date(e),write:e=>e.toISOString()}},Z="vueuse-storage";function st(e,t,o,s={}){var n;const{flush:i="pre",deep:d=!0,listenToStorageChanges:g=!0,writeDefaults:_=!0,mergeDefaults:f=!1,shallow:m,window:c=W,eventFilter:b,onError:v=a=>{console.error(a)},initOnMounted:k}=s,V=(m?be:E)(typeof t=="function"?t():t);if(!o)try{o=tt("getDefaultStorage",()=>{var a;return(a=W)==null?void 0:a.localStorage})()}catch(a){v(a)}if(!o)return V;const y=K(t),C=ot(y),r=(n=s.serializer)!=null?n:nt[C],{pause:T,resume:S}=Qe(V,()=>D(V.value),{flush:i,deep:d,eventFilter:b});c&&g&&Xe(()=>{Y(c,"storage",q),Y(c,Z,j),k&&q()}),k||q();function A(a,l){c&&c.dispatchEvent(new CustomEvent(Z,{detail:{key:e,oldValue:a,newValue:l,storageArea:o}}))}function D(a){try{const l=o.getItem(e);if(a==null)A(l,null),o.removeItem(e);else{const x=r.write(a);l!==x&&(o.setItem(e,x),A(l,x))}}catch(l){v(l)}}function $(a){const l=a?a.newValue:o.getItem(e);if(l==null)return _&&y!=null&&o.setItem(e,r.write(y)),y;if(!a&&f){const x=r.read(l);return typeof f=="function"?f(x,y):C==="object"&&!Array.isArray(x)?{...y,...x}:x}else return typeof l!="string"?l:r.read(l)}function q(a){if(!(a&&a.storageArea!==o)){if(a&&a.key==null){V.value=y;return}if(!(a&&a.key!==e)){T();try{(a==null?void 0:a.newValue)!==r.write(V.value)&&(V.value=$(a))}catch(l){v(l)}finally{a?ne(S):S()}}}}function j(a){q(a.detail)}return V}const lt="http://localhost:3001";async function ee(e,t="get",o){const s=Ne(),n=se(),i=xe("access_token");let d=[];async function g(f,m){let c=null;const b={method:m==="get"?"GET":"POST",credentials:"include",headers:{custom_header_for_token:i.value},body:m==="save"?o:null};return c=await $fetch(`${lt}/api/${m}/user/${f}`,b),c[f]?(s.data[f]=c[f],c[f]):(s.data[f]={},c)}function _(f,m){const c=st(f,[]);if(m==="get")return c.value?c.value:[];if(m==="save")return c.value=o,c.value}return s.data[e]||(s.data[e]=[]),t==="get"&&(Object.keys(s.data[e]).length===0&&n.authenticated?d=await g(e,t):Object.keys(s.data[e]).length===0&&n.guest?d=_(e,t):d=s.data[e]),t==="save"&&(n.authenticated?d=await g(e,t):n.guest?d=_(e,t):d=s.data[e]),d||[]}const rt=["fill","width","height"],at=N("path",{d:"M19.587 16.001l6.096 6.096c0.396 0.396 0.396 1.039 0 1.435l-2.151 2.151c-0.396 0.396-1.038 0.396-1.435 0l-6.097-6.096-6.097 6.096c-0.396 0.396-1.038 0.396-1.434 0l-2.152-2.151c-0.396-0.396-0.396-1.038 0-1.435l6.097-6.096-6.097-6.097c-0.396-0.396-0.396-1.039 0-1.435l2.153-2.151c0.396-0.396 1.038-0.396 1.434 0l6.096 6.097 6.097-6.097c0.396-0.396 1.038-0.396 1.435 0l2.151 2.152c0.396 0.396 0.396 1.038 0 1.435l-6.096 6.096z"},null,-1),it=[at],ut={__name:"IconCross",props:{size:String,color:String},setup(e){return(t,o)=>(w(),O("svg",{fill:e.color?e.color:"#ffffff",width:e.size?e.size:"1rem",height:e.size?e.size:"1rem",viewBox:"0 0 32 32",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},it,8,rt))}},ct=ut,ae=e=>(ye("data-v-48b09a7b"),e=e(),Se(),e),dt={class:"text-xl mb-3"},ft={key:0,class:"text-base sm:text-lg mb-2"},mt={class:"flex flex-col mb-5"},pt={class:"flex flex-col items-start w-full"},_t=["onClick"],vt={class:"flex items-center justify-end mt-3"},ht=ae(()=>N("div",{class:"text-h6"}," Удалить задачу ",-1)),gt=ae(()=>N("div",{class:"text-h6"}," Ошибка ",-1)),bt={__name:"TodoItem",props:{itemProp:Object,index:Number},emits:["save","remove"],setup(e,{emit:t}){const o=e,s=t,n=E(JSON.parse(JSON.stringify(o.itemProp))),i=E(JSON.parse(JSON.stringify(o.itemProp))),d=E(n.value.id===-1),g=E(!1),_=E({message:"",showError:!1});B(o,C=>{n.value=JSON.parse(JSON.stringify(C.itemProp)),i.value=JSON.parse(JSON.stringify(C.itemProp)),d.value=!1});function f(){return!n.value.title&&!n.value.text&&!n.value.steps.length}function m(){n.value.steps||(n.value.steps=[]),n.value.steps.push({title:"",checked:!1})}function c(C){n.value.steps.splice(C,1)}function b(){i.value=JSON.parse(JSON.stringify(n.value)),d.value=!0}function v(){f()||(i.value=n.value,d.value=!1,s("save",n.value))}function k(){!i.value.title&&!i.value.text&&!i.value.steps.length?y():(n.value=i.value,d.value=!1)}function V(){g.value=!0}function y(){s("remove")}return(C,r)=>{const T=Fe,S=le,A=qe,D=Ae,$=Ee,q=De,j=Te,a=Pe;return w(),O(J,null,[p(d)===!1?(w(),U(A,{key:0,class:"p-4 m-2.5 w-full md:w-80 flex flex-col"},{default:h(()=>[N("h5",dt,L(p(n).title),1),p(n).text?(w(),O("div",ft,L(p(n).text),1)):M("",!0),N("div",mt,[(w(!0),O(J,null,R(p(n).steps,(l,x)=>(w(),U(T,{key:x,modelValue:l.checked,"onUpdate:modelValue":[I=>l.checked=I,r[0]||(r[0]=I=>v())],label:l.title,class:"q-custom-checkbox"},null,8,["modelValue","onUpdate:modelValue","label"]))),128))]),u(S,{color:"primary",class:"mt-auto","text-color":"white",label:"Редактировать",onClick:r[1]||(r[1]=l=>b())})]),_:1})):M("",!0),u(q,{modelValue:p(d),"onUpdate:modelValue":r[8]||(r[8]=l=>H(d)?d.value=l:null)},{default:h(()=>[u(A,null,{default:h(()=>[u($,null,{default:h(()=>[u(D,{modelValue:p(n).title,"onUpdate:modelValue":r[2]||(r[2]=l=>p(n).title=l),label:"Заголовок",autofocus:""},null,8,["modelValue"]),u(D,{modelValue:p(n).text,"onUpdate:modelValue":r[3]||(r[3]=l=>p(n).text=l),type:"textarea",autogrow:"",label:"Описание"},null,8,["modelValue"])]),_:1}),u($,null,{default:h(()=>[N("div",pt,[(w(!0),O(J,null,R(p(n).steps,(l,x)=>(w(),O("div",{key:x,class:"flex flex-nowrap items-center w-full"},[u(T,{modelValue:l.checked,"onUpdate:modelValue":I=>l.checked=I,class:"q-custom-checkbox"},null,8,["modelValue","onUpdate:modelValue"]),u(D,{modelValue:l.title,"onUpdate:modelValue":I=>l.title=I,placeholder:"Пункт",class:"w-full"},null,8,["modelValue","onUpdate:modelValue"]),N("button",{class:"remove",onClick:I=>c(x)},[u(ct,{color:"red",size:"1.5rem"})],8,_t)]))),128))])]),_:1}),u($,null,{default:h(()=>[N("div",vt,[u(S,{class:"bg-darkgreen m-1",size:"sm","text-color":"white",label:"Добавить этап",onClick:r[4]||(r[4]=l=>m())}),u(S,{class:"bg-darkgray m-1",size:"sm","text-color":"white",label:"Удалить",onClick:r[5]||(r[5]=l=>V())}),u(S,{class:"bg-red m-1",size:"sm","text-color":"white",label:"Отмена",onClick:r[6]||(r[6]=l=>k())}),u(S,{class:"bg-green m-1",size:"sm","text-color":"white",label:"Сохранить",onClick:r[7]||(r[7]=l=>v(!0))})])]),_:1})]),_:1})]),_:1},8,["modelValue"]),u(q,{modelValue:p(g),"onUpdate:modelValue":r[10]||(r[10]=l=>H(g)?g.value=l:null)},{default:h(()=>[u(A,null,{default:h(()=>[u($,null,{default:h(()=>[ht]),_:1}),u($,{class:"q-pt-none"},{default:h(()=>[G(" Отменить это действие будет невозможно ")]),_:1}),u(j,{align:"right"},{default:h(()=>[Q(u(S,{flat:"",label:"OK",color:"primary",onClick:r[9]||(r[9]=l=>y())},null,512),[[a]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),u(q,{modelValue:p(_).showError,"onUpdate:modelValue":r[12]||(r[12]=l=>p(_).showError=l)},{default:h(()=>[u(A,null,{default:h(()=>[u($,null,{default:h(()=>[gt]),_:1}),u($,{class:"q-pt-none"},{default:h(()=>[G(L(p(_).message),1)]),_:1}),u(j,{align:"right"},{default:h(()=>[Q(u(S,{flat:"",label:"OK",color:"primary",onClick:r[11]||(r[11]=l=>p(_).showError=!1)},null,512),[[a]])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}},xt=we(bt,[["__scopeId","data-v-48b09a7b"]]),wt={class:"flex justify-center"},yt={key:0,class:"empty"},St={__name:"Todo",async setup(e){let t,o;const s=[{message:"Сохранено",bgColor:"green",position:"bottom-right"},{message:"Ошибка",bgColor:"red",position:"bottom-right"}],n=se(),i=E(([t,o]=ke(()=>ee("todo","get")),t=await t,o(),t));function d(){i.value.push({id:-1,title:"",text:"",steps:[]})}function g(f){i.value.splice(f,1),_()}async function _(f,m){f.id===-1&&n.guest===!0&&(f.id=i.value.length+1),i.value[m]=f,i.value=await ee("todo","save",i.value),Oe(s[0])}return(f,m)=>{const c=le;return w(),O(J,null,[N("div",wt,[(w(!0),O(J,null,R(p(i),(b,v)=>(w(),U(xt,{key:v,"item-prop":b,index:v,onSave:k=>_(k,v),onRemove:k=>g(v)},null,8,["item-prop","index","onSave","onRemove"]))),128)),p(i).length?M("",!0):(w(),O("span",yt,"Нет задач"))]),u(c,{label:"Добавить задачу",color:"positive","text-color":"white",class:"mt-5 mx-auto",onClick:m[0]||(m[0]=b=>d())})],64)}}},kt=St,zt={__name:"todo",setup(e){return Je({title:"Список задач"}),(t,o)=>{const s=kt;return w(),U(s)}}};export{zt as default};
