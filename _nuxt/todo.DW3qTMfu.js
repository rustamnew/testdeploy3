import{l as te,al as ie,am as ue,m as oe,q as z,O as ce,_ as de,Y as fe,B as me,u as p,H as pe,D as ne,g as E,an as _e,G as R,ao as ve,ap as he,J as ge,aq as be,ar as le,as as we,o as x,c as N,a as $,k as U,w as h,t as M,f as L,F as J,r as W,b as c,x as H,d as G,j as Q,z as se,p as xe,e as ye,at as Se,au as ke}from"./entry.DCNB1XUa.js";import{u as Ve}from"./data.CyXGuqNC.js";import{u as Ce,a as Oe,b as Ne}from"./use-checkbox.CFOF4ENy.js";import{_ as $e,a as qe}from"./QCardSection.D4GnZd4j.js";import{_ as Ee}from"./QInput.BrSrZ1_G.js";import{m as Ae,n as Ie,_ as ze}from"./QDialog.BcUMCKK0.js";import{_ as De}from"./_plugin-vue_export-helper.DlAUqK2U.js";import{u as Je}from"./vue.f36acd1f.CEQ2frYa.js";import"./use-dark.BOOzoC_p.js";import"./use-timeout.BgTDjfJS.js";const Te=te({name:"QCardActions",props:{...ie,vertical:Boolean},setup(e,{slots:t}){const o=ue(e),l=oe(()=>`q-card__actions ${o.value} q-card__actions--${e.vertical===!0?"vert column":"horiz row"}`);return()=>z("div",{class:l.value},ce(t.default))}}),je=z("div",{key:"svg",class:"q-checkbox__bg absolute"},[z("svg",{class:"q-checkbox__svg fit absolute-full",viewBox:"0 0 24 24"},[z("path",{class:"q-checkbox__truthy",fill:"none",d:"M1.73,12.91 8.1,19.28 22.79,4.59"}),z("path",{class:"q-checkbox__indet",d:"M4,14H20V10H4"})])]),Fe=te({name:"QCheckbox",props:Ce,emits:Oe,setup(e){function t(o,l){const n=oe(()=>(o.value===!0?e.checkedIcon:l.value===!0?e.indeterminateIcon:e.uncheckedIcon)||null);return()=>n.value!==null?[z("div",{key:"icon",class:"q-checkbox__icon-container absolute-full flex flex-center no-wrap"},[z(de,{class:"q-checkbox__icon",name:n.value})])]:[je]}return Ne("checkbox",t)}});function Y(e){if(e===!1)return 0;if(e===!0||e===void 0)return 1;const t=parseInt(e,10);return isNaN(t)?0:t}const Pe=fe({name:"close-popup",beforeMount(e,{value:t}){const o={depth:Y(t),handler(l){o.depth!==0&&setTimeout(()=>{const n=Ae(e);n!==void 0&&Ie(n,l,o.depth)})},handlerKey(l){me(l,13)===!0&&o.handler(l)}};e.__qclosepopup=o,e.addEventListener("click",o.handler),e.addEventListener("keyup",o.handlerKey)},updated(e,{value:t,oldValue:o}){t!==o&&(e.__qclosepopup.depth=Y(t))},beforeUnmount(e){const t=e.__qclosepopup;e.removeEventListener("click",t.handler),e.removeEventListener("keyup",t.handlerKey),delete e.__qclosepopup}});function Ue(e){return ve()?(he(e),!0):!1}function K(e){return typeof e=="function"?e():p(e)}const Me=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const Le=Object.prototype.toString,We=e=>Le.call(e)==="[object Object]",Be=()=>{};function Re(e,t){function o(...l){return new Promise((n,a)=>{Promise.resolve(e(()=>t.apply(this,l),{fn:t,thisArg:this,args:l})).then(n).catch(a)})}return o}const re=e=>e();function Ke(e=re){const t=E(!0);function o(){t.value=!1}function l(){t.value=!0}const n=(...a)=>{t.value&&e(...a)};return{isActive:_e(t),pause:o,resume:l,eventFilter:n}}function He(e){return e||ge()}function Ge(e,t,o={}){const{eventFilter:l=re,...n}=o;return R(e,Re(l,t),n)}function Qe(e,t,o={}){const{eventFilter:l,...n}=o,{eventFilter:a,pause:f,resume:g,isActive:_}=Ke(l);return{stop:Ge(e,t,{...n,eventFilter:a}),pause:f,resume:g,isActive:_}}function Ye(e,t=!0,o){He()?pe(e,o):t?e():ne(e)}function Xe(e){var t;const o=K(e);return(t=o==null?void 0:o.$el)!=null?t:o}const B=Me?window:void 0;function X(...e){let t,o,l,n;if(typeof e[0]=="string"||Array.isArray(e[0])?([o,l,n]=e,t=B):[t,o,l,n]=e,!t)return Be;Array.isArray(o)||(o=[o]),Array.isArray(l)||(l=[l]);const a=[],f=()=>{a.forEach(m=>m()),a.length=0},g=(m,d,b,v)=>(m.addEventListener(d,b,v),()=>m.removeEventListener(d,b,v)),_=R(()=>[Xe(t),K(n)],([m,d])=>{if(f(),!m)return;const b=We(d)?{...d}:d;a.push(...o.flatMap(v=>l.map(k=>g(m,v,k,b))))},{immediate:!0,flush:"post"}),u=()=>{_(),f()};return Ue(u),u}const F=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},P="__vueuse_ssr_handlers__",Ze=et();function et(){return P in F||(F[P]=F[P]||{}),F[P]}function tt(e,t){return Ze[e]||t}function ot(e){return e==null?"any":e instanceof Set?"set":e instanceof Map?"map":e instanceof Date?"date":typeof e=="boolean"?"boolean":typeof e=="string"?"string":typeof e=="object"?"object":Number.isNaN(e)?"any":"number"}const nt={boolean:{read:e=>e==="true",write:e=>String(e)},object:{read:e=>JSON.parse(e),write:e=>JSON.stringify(e)},number:{read:e=>Number.parseFloat(e),write:e=>String(e)},any:{read:e=>e,write:e=>String(e)},string:{read:e=>e,write:e=>String(e)},map:{read:e=>new Map(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e.entries()))},set:{read:e=>new Set(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e))},date:{read:e=>new Date(e),write:e=>e.toISOString()}},Z="vueuse-storage";function lt(e,t,o,l={}){var n;const{flush:a="pre",deep:f=!0,listenToStorageChanges:g=!0,writeDefaults:_=!0,mergeDefaults:u=!1,shallow:m,window:d=B,eventFilter:b,onError:v=i=>{console.error(i)},initOnMounted:k}=l,V=(m?be:E)(typeof t=="function"?t():t);if(!o)try{o=tt("getDefaultStorage",()=>{var i;return(i=B)==null?void 0:i.localStorage})()}catch(i){v(i)}if(!o)return V;const y=K(t),C=ot(y),r=(n=l.serializer)!=null?n:nt[C],{pause:T,resume:S}=Qe(V,()=>D(V.value),{flush:a,deep:f,eventFilter:b});d&&g&&Ye(()=>{X(d,"storage",q),X(d,Z,j),k&&q()}),k||q();function A(i,s){d&&d.dispatchEvent(new CustomEvent(Z,{detail:{key:e,oldValue:i,newValue:s,storageArea:o}}))}function D(i){try{const s=o.getItem(e);if(i==null)A(s,null),o.removeItem(e);else{const w=r.write(i);s!==w&&(o.setItem(e,w),A(s,w))}}catch(s){v(s)}}function O(i){const s=i?i.newValue:o.getItem(e);if(s==null)return _&&y!=null&&o.setItem(e,r.write(y)),y;if(!i&&u){const w=r.read(s);return typeof u=="function"?u(w,y):C==="object"&&!Array.isArray(w)?{...y,...w}:w}else return typeof s!="string"?s:r.read(s)}function q(i){if(!(i&&i.storageArea!==o)){if(i&&i.key==null){V.value=y;return}if(!(i&&i.key!==e)){T();try{(i==null?void 0:i.newValue)!==r.write(V.value)&&(V.value=O(i))}catch(s){v(s)}finally{i?ne(S):S()}}}}function j(i){q(i.detail)}return V}const st="http://localhost:3001";async function ee(e,t="get",o){const l=Ve(),n=le(),a=we("access_token");let f=[];async function g(u,m){let d=null;const b={method:m==="get"?"GET":"POST",credentials:"include",headers:{custom_header_for_token:a.value},body:m==="save"?o:null};return d=await $fetch(`${st}/api/${m}/user/${u}`,b),d[u]?(l.data[u]=d[u],d[u]):(l.data[u]={},d)}function _(u,m){const d=lt(u,[]);if(m==="get")return d.value?d.value:[];if(m==="save")return d.value=o,d.value}return l.data[e]||(l.data[e]=[]),t==="get"&&(Object.keys(l.data[e]).length===0&&n.authenticated?f=await g(e,t):Object.keys(l.data[e]).length===0&&n.guest?f=_(e,t):f=l.data[e]),t==="save"&&(n.authenticated?f=await g(e,t):n.guest?f=_(e,t):f=l.data[e]),f||[]}const rt=["fill","width","height"],at=$("path",{d:"M19.587 16.001l6.096 6.096c0.396 0.396 0.396 1.039 0 1.435l-2.151 2.151c-0.396 0.396-1.038 0.396-1.435 0l-6.097-6.096-6.097 6.096c-0.396 0.396-1.038 0.396-1.434 0l-2.152-2.151c-0.396-0.396-0.396-1.038 0-1.435l6.097-6.096-6.097-6.097c-0.396-0.396-0.396-1.039 0-1.435l2.153-2.151c0.396-0.396 1.038-0.396 1.434 0l6.096 6.097 6.097-6.097c0.396-0.396 1.038-0.396 1.435 0l2.151 2.152c0.396 0.396 0.396 1.038 0 1.435l-6.096 6.096z"},null,-1),it=[at],ut={__name:"IconCross",props:{size:String,color:String},setup(e){return(t,o)=>(x(),N("svg",{fill:e.color?e.color:"#ffffff",width:e.size?e.size:"1rem",height:e.size?e.size:"1rem",viewBox:"0 0 32 32",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},it,8,rt))}},ct=ut,ae=e=>(xe("data-v-fd1268b0"),e=e(),ye(),e),dt={class:"text-xl mb-3"},ft={key:0,class:"text-base sm:text-lg mb-2"},mt={class:"flex flex-col mb-5"},pt={class:"flex flex-col items-start w-full"},_t=["onClick"],vt={class:"flex items-center justify-end mt-3"},ht=ae(()=>$("div",{class:"text-h6"}," Удалить задачу ",-1)),gt=ae(()=>$("div",{class:"text-h6"}," Ошибка ",-1)),bt={__name:"TodoItem",props:{itemProp:Object,index:Number},emits:["save","remove"],setup(e,{emit:t}){const o=e,l=t,n=E(JSON.parse(JSON.stringify(o.itemProp))),a=E(JSON.parse(JSON.stringify(o.itemProp))),f=E(n.value.id===-1),g=E(!1),_=E({message:"",showError:!1});R(o,C=>{n.value=JSON.parse(JSON.stringify(C.itemProp)),a.value=JSON.parse(JSON.stringify(C.itemProp)),f.value=!1});function u(){return!n.value.title&&!n.value.text&&!n.value.steps.length}function m(){n.value.steps||(n.value.steps=[]),n.value.steps.push({title:"",checked:!1})}function d(C){n.value.steps.splice(C,1)}function b(){a.value=JSON.parse(JSON.stringify(n.value)),f.value=!0}function v(){u()||(a.value=n.value,f.value=!1,l("save",n.value))}function k(){!a.value.title&&!a.value.text&&!a.value.steps.length?y():(n.value=a.value,f.value=!1)}function V(){g.value=!0}function y(){l("remove")}return(C,r)=>{const T=Fe,S=se,A=$e,D=Ee,O=qe,q=ze,j=Te,i=Pe;return x(),N(J,null,[p(f)===!1?(x(),U(A,{key:0,class:"p-4 m-2.5 w-full md:w-80 flex flex-col"},{default:h(()=>[$("h5",dt,M(p(n).title),1),p(n).text?(x(),N("div",ft,M(p(n).text),1)):L("",!0),$("div",mt,[(x(!0),N(J,null,W(p(n).steps,(s,w)=>(x(),U(T,{key:w,modelValue:s.checked,"onUpdate:modelValue":[I=>s.checked=I,r[0]||(r[0]=I=>v())],label:s.title,class:"q-custom-checkbox"},null,8,["modelValue","onUpdate:modelValue","label"]))),128))]),c(S,{color:"primary",class:"mt-auto","text-color":"white",label:"Редактировать",onClick:r[1]||(r[1]=s=>b())})]),_:1})):L("",!0),c(q,{modelValue:p(f),"onUpdate:modelValue":r[8]||(r[8]=s=>H(f)?f.value=s:null)},{default:h(()=>[c(A,null,{default:h(()=>[c(O,null,{default:h(()=>[c(D,{modelValue:p(n).title,"onUpdate:modelValue":r[2]||(r[2]=s=>p(n).title=s),label:"Заголовок",autofocus:""},null,8,["modelValue"]),c(D,{modelValue:p(n).text,"onUpdate:modelValue":r[3]||(r[3]=s=>p(n).text=s),type:"textarea",autogrow:"",label:"Описание"},null,8,["modelValue"])]),_:1}),c(O,null,{default:h(()=>[$("div",pt,[(x(!0),N(J,null,W(p(n).steps,(s,w)=>(x(),N("div",{key:w,class:"flex flex-nowrap items-center w-full"},[c(T,{modelValue:s.checked,"onUpdate:modelValue":I=>s.checked=I,class:"q-custom-checkbox"},null,8,["modelValue","onUpdate:modelValue"]),c(D,{modelValue:s.title,"onUpdate:modelValue":I=>s.title=I,placeholder:"Пункт",class:"w-full"},null,8,["modelValue","onUpdate:modelValue"]),$("button",{class:"remove",onClick:I=>d(w)},[c(ct,{color:"red",size:"1.5rem"})],8,_t)]))),128))])]),_:1}),c(O,null,{default:h(()=>[$("div",vt,[c(S,{class:"bg-darkgreen m-1",size:"sm","text-color":"white",label:"Добавить этап",onClick:r[4]||(r[4]=s=>m())}),c(S,{class:"bg-darkgray m-1",size:"sm","text-color":"white",label:"Удалить",onClick:r[5]||(r[5]=s=>V())}),c(S,{class:"bg-red m-1",size:"sm","text-color":"white",label:"Отмена",onClick:r[6]||(r[6]=s=>k())}),c(S,{class:"bg-green m-1",size:"sm","text-color":"white",label:"Сохранить",onClick:r[7]||(r[7]=s=>v(!0))})])]),_:1})]),_:1})]),_:1},8,["modelValue"]),c(q,{modelValue:p(g),"onUpdate:modelValue":r[10]||(r[10]=s=>H(g)?g.value=s:null)},{default:h(()=>[c(A,null,{default:h(()=>[c(O,null,{default:h(()=>[ht]),_:1}),c(O,{class:"q-pt-none"},{default:h(()=>[G(" Отменить это действие будет невозможно ")]),_:1}),c(j,{align:"right"},{default:h(()=>[Q(c(S,{flat:"",label:"OK",color:"primary",onClick:r[9]||(r[9]=s=>y())},null,512),[[i]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),c(q,{modelValue:p(_).showError,"onUpdate:modelValue":r[12]||(r[12]=s=>p(_).showError=s)},{default:h(()=>[c(A,null,{default:h(()=>[c(O,null,{default:h(()=>[gt]),_:1}),c(O,{class:"q-pt-none"},{default:h(()=>[G(M(p(_).message),1)]),_:1}),c(j,{align:"right"},{default:h(()=>[Q(c(S,{flat:"",label:"OK",color:"primary",onClick:r[11]||(r[11]=s=>p(_).showError=!1)},null,512),[[i]])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}},wt=De(bt,[["__scopeId","data-v-fd1268b0"]]),xt={class:"flex justify-center"},yt={key:0,class:"empty"},St={__name:"Todo",async setup(e){let t,o;const l=[{message:"Сохранено",bgColor:"green",position:"bottom-right"},{message:"Ошибка",bgColor:"red",position:"bottom-right"}],n=le(),a=E(([t,o]=Se(()=>ee("todo","get")),t=await t,o(),t));function f(){a.value.push({id:-1,title:"",text:"",steps:[]})}function g(u){a.value.splice(u,1),_()}async function _(u,m){u&&u.id===-1&&n.guest===!0?(u.id=a.value.length+1,a.value[m]=u):u&&(a.value[m]=u),a.value=await ee("todo","save",a.value),ke(l[0])}return(u,m)=>{const d=se;return x(),N(J,null,[$("div",xt,[(x(!0),N(J,null,W(p(a),(b,v)=>(x(),U(wt,{key:v,"item-prop":b,index:v,onSave:k=>_(k,v),onRemove:k=>g(v)},null,8,["item-prop","index","onSave","onRemove"]))),128)),p(a).length?L("",!0):(x(),N("span",yt,"Нет задач"))]),c(d,{label:"Добавить задачу",color:"positive","text-color":"white",class:"mt-5 mx-auto",onClick:m[0]||(m[0]=b=>f())})],64)}}},kt=St,Dt={__name:"todo",setup(e){return Je({title:"Список задач"}),(t,o)=>{const l=kt;return x(),U(l)}}};export{Dt as default};
